<div class="layout">
  <!-- Sidebar -->
  <aside class="sidebar">
    <h2 class="logo">
      <i class="fas fa-chart-line"></i>
      Appraise360
    </h2>
    <ul>
      <li *ngFor="let item of menuItems" (click)="navigateTo(item.route)">
        <i [ngClass]="['fas', item.icon]"></i> {{ item.title }}
      </li>
    </ul>
  </aside>

  <!-- Main content -->
  <div class="main">
    <!-- Topbar -->
    <header class="topbar">
      <div class="topbar-left">
        <h1>Appraise360 Dashboard</h1>
        <p class="subtitle">Monitor and manage employee performance reviews and appraisals</p>
      </div>
      <div class="topbar-right">
        <div class="user-info">
          <i class="fas fa-user-circle"></i>
          <span>Admin User</span>
        </div>
        <button class="logout-btn" (click)="logout()">
          <i class="fas fa-sign-out-alt"></i> Logout
        </button>
      </div>
    </header>

    <!-- Dashboard Content -->
    <div class="dashboard-content">
      <!-- Employee Statistics Cards -->
      <div class="section-header">
        <h2>Employee Overview</h2>
      </div>
      <div class="cards">
        <div class="card" (click)="navigateTo('/employee-profile')">
          <div class="card-header">
            <i class="fas fa-users icon" style="color: #3b82f6;"></i>
            <span class="trend positive">+{{ employeeStats.newlyJoined }} this month</span>
          </div>
          <div class="card-body">
            <div class="value">{{ employeeStats.totalEmployees }}</div>
            <div class="title">Total Employees</div>
          </div>
        </div>

        <div class="card" (click)="navigateTo('/employee-profile')">
          <div class="card-header">
            <i class="fas fa-user-check icon" style="color: #059669;"></i>
            <span class="trend positive">Active</span>
          </div>
          <div class="card-body">
            <div class="value">{{ employeeStats.activeEmployees }}</div>
            <div class="title">Active Employees</div>
          </div>
        </div>

        <div class="card" (click)="navigateTo('/employee-profile')">
          <div class="card-header">
            <i class="fas fa-building icon" style="color: #8b5cf6;"></i>
            <span class="trend positive">Departments</span>
          </div>
          <div class="card-body">
            <div class="value">{{ employeeStats.totalDepartments }}</div>
            <div class="title">Total Departments</div>
          </div>
        </div>
      </div>

      <!-- Performance Metrics Section -->
      <div class="analytics-section">
        <div class="section-header">
          <!-- Removed <h2>Performance Analytics</h2> -->
        </div>
        <div class="analytics-grid">
          <div class="metric-card" *ngFor="let metric of performanceMetrics">
            <div class="metric-header">
              <h3>{{ metric.label }}</h3>
              <span class="metric-value">{{ metric.value }}{{ metric.unit }}</span>
            </div>
            <div class="progress-container">
              <div class="progress-bar">
                <div class="progress-fill" 
                     [ngClass]="getMetricStatus(metric)"
                     [style.width.%]="getMetricProgress(metric)">
                </div>
              </div>
              <div class="progress-label">
                Target: {{ metric.target }}{{ metric.unit }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Activities Section -->
      <div class="activities-section">
        <div class="section-header">
          <h2>Recent Activities</h2>
          <button class="view-all-btn">View All</button>
        </div>
        <div class="activities-list">
          <div class="activity-item" *ngFor="let activity of recentActivities">
            <div class="activity-icon" [ngClass]="activity.status">
              <i [ngClass]="['fas', getActivityIcon(activity.type)]"></i>
            </div>
            <div class="activity-content">
              <div class="activity-description">{{ activity.description }}</div>
              <div class="activity-meta">
                <span class="activity-time">{{ formatTimestamp(activity.timestamp) }}</span>
                <span class="activity-status" [ngClass]="activity.status">{{ activity.status }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Employee List Section -->
      <div class="employees-section" *ngIf="!isLoading">
        <div class="section-header">
          <h2>All Employees</h2>
          <span class="employee-count">{{ allEmployees.length }} employees</span>
        </div>
        <div class="employees-grid">
          <div class="employee-card" *ngFor="let employee of allEmployees" (click)="viewEmployeeProfile(employee.employeeProfileId || 0)">
            <div class="employee-header">
              <div class="employee-avatar">
                <i class="fas fa-user"></i>
              </div>
              <div class="employee-info">
                <h3>{{ employee.user?.fullName || 'Unknown' }}</h3>
                <p class="employee-role">{{ employee.designation || 'No designation' }}</p>
                <p class="employee-department">{{ employee.department || 'No department' }}</p>
              </div>
            </div>
            <div class="employee-stats">
              <div class="stat-item">
                <span class="stat-label">Goals</span>
                <span class="stat-value">{{ getEmployeeGoals(employee.employeeProfileId || 0).length }}</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Completed</span>
                <span class="stat-value">{{ getCompletedGoalsCount(employee.employeeProfileId || 0) }}</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">Rating</span>
                <span class="stat-value">{{ getEmployeePerformanceSummary(employee.employeeProfileId || 0).averageRating.toFixed(1) }}</span>
              </div>
            </div>
            <div class="employee-progress">
              <div class="progress-bar">
                <div class="progress-fill" 
                     [style.width.%]="getEmployeePerformanceSummary(employee.employeeProfileId || 0).completionRate">
                </div>
              </div>
              <span class="progress-text">{{ getEmployeePerformanceSummary(employee.employeeProfileId || 0).completionRate.toFixed(0) }}% Complete</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Loading State -->
      <div class="loading-section" *ngIf="isLoading">
        <div class="loading-spinner">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading employee data...</p>
        </div>
      </div>

      <!-- Quick Actions Section -->
      <div class="quick-actions-section">
        <div class="section-header">
          <h2>Quick Actions</h2>
        </div>
        <div class="quick-actions">
          <button class="action-btn primary" (click)="navigateTo('/appraisal')">
            <i class="fas fa-clipboard-check"></i>
            Start New Appraisal
          </button>
          <button class="action-btn secondary" (click)="navigateTo('/employee-profile')">
            <i class="fas fa-user-plus"></i>
            Add Employee
          </button>
          <button class="action-btn secondary" (click)="navigateTo('/goal')">
            <i class="fas fa-bullseye"></i>
            Set Goals
          </button>
          <button class="action-btn secondary" (click)="navigateTo('/review-cycle')">
            <i class="fas fa-calendar-alt"></i>
            Schedule Review
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
