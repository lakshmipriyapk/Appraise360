<div class="signup-page">
  <header class="header" [class.scrolled]="isScrolled">
    <div class="logo">
      <i class="fas fa-chart-line"></i>
      <span>Appraise360</span>
    </div>
    <nav>
      <a routerLink="/" class="btn-primary">Home</a>
    </nav>
  </header>

  <div class="signup-container">
  <div class="form-container">
    <h2 class="title">Create Your Account</h2>

    <form #signupForm="ngForm" (ngSubmit)="onSubmit(signupForm)" class="form">
      <!-- Full Name -->
      <div class="input-group">
        <label for="fullName">Full Name</label>
        <input type="text" id="fullName" name="fullName" [(ngModel)]="signupData.fullName" required #fullName="ngModel"/>
        <div *ngIf="fullName.invalid && fullName.touched" class="error">Full Name is required</div>
      </div>

      <!-- Email -->
      <div class="input-group">
        <label for="email">Work Email</label>
        <input type="email" id="email" name="email" [(ngModel)]="signupData.email" required #email="ngModel"/>
        <div *ngIf="email.invalid && email.touched" class="error">Valid email required</div>
      </div>

      <!-- Phone -->
      <div class="input-group">
        <label for="phone">Phone Number</label>
        <input type="tel" id="phone" name="phone" [(ngModel)]="signupData.phone" pattern="[0-9]{10}" required #phone="ngModel"/>
        <div *ngIf="phone.invalid && phone.touched" class="error">10-digit phone required</div>
      </div>

      <!-- Role Selection -->
      <div class="input-group">
        <label for="role">Role</label>
        <select id="role" name="role" [(ngModel)]="signupData.role" required #role="ngModel" class="form-select">
          <option value="">Select your role</option>
          <option value="Employee">Employee</option>
          <option value="Admin">Manager</option>
        </select>
        <div *ngIf="role.invalid && role.touched" class="error">Please select your role</div>
      </div>

      <!-- Password -->
      <div class="input-group password-container">
        <label for="password">Password</label>
        <input [type]="showPassword ? 'text' : 'password'" id="password" name="password" [(ngModel)]="signupData.password" required #password="ngModel" minlength="6"/>
        <i class="fas password-toggle-icon" [ngClass]="showPassword ? 'fa-eye-slash' : 'fa-eye'" (click)="togglePassword()"></i>
        <div *ngIf="password.invalid && password.touched" class="error">
          <div *ngIf="password.errors?.['required']">Password is required</div>
          <div *ngIf="password.errors?.['minlength']">Password must be at least 6 characters</div>
        </div>
      </div>

      <!-- Confirm Password -->
      <div class="input-group password-container">
        <label for="confirmPassword">Confirm Password</label>
        <input [type]="showConfirmPassword ? 'text' : 'password'" id="confirmPassword" name="confirmPassword" [(ngModel)]="signupData.confirmPassword" required #confirmPassword="ngModel" (input)="checkPasswordMatch()"/>
        <i class="fas password-toggle-icon" [ngClass]="showConfirmPassword ? 'fa-eye-slash' : 'fa-eye'" (click)="toggleConfirmPassword()"></i>
        <div *ngIf="confirmPassword.invalid && confirmPassword.touched" class="error">
          <div *ngIf="confirmPassword.errors?.['required']">Please confirm your password</div>
        </div>
        <div *ngIf="passwordMismatch" class="error">Passwords do not match</div>
      </div>

      <button type="submit" class="btn-primary" [disabled]="!isFormValid() || isLoading">
        <i *ngIf="isLoading" class="fas fa-spinner fa-spin"></i>
        {{ isLoading ? 'Creating Account...' : 'Create Account' }}
      </button>
    </form>

    <p class="helper-text">Already have an account? <a routerLink="/login" class="link">Log In</a></p>
  </div>
</div>

<!-- Modal -->
<div class="modal" *ngIf="showMessage">
  <div class="modal-content">
    <div class="modal-header">
      <h3 [class.success]="messageTitle.includes('Successfully')" [class.error]="messageTitle.includes('Failed')">
        <i *ngIf="messageTitle.includes('Successfully')" class="fas fa-check-circle"></i>
        <i *ngIf="messageTitle.includes('Failed')" class="fas fa-exclamation-triangle"></i>
        {{ messageTitle }}
      </h3>
    </div>
    <div class="modal-body">
      <p>{{ messageText }}</p>
    </div>
    <div class="modal-footer">
      <button class="btn-primary" (click)="closeMessage()">OK</button>
    </div>
  </div>
</div>

</div>
